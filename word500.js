const height=8,width=5,keys=["US","Q","W","E","R","T","Y","U","I","O","P","Hint","A","S","D","F","G","H","J","K","L","Back","Z","X","C","V","B","N","M","Spec","Enter"],langs=["en","es","de","fr","nl","it","pt","ca"],levels=["A","B","C"];let lang,level,exclude,word,words,wordlist,row=0,col=0,gameOver=!1,hintsUsed=0,guesses=["","","","","","","","","",""];function initialize(){for(let e=0;e<8;e++)for(let t=0;t<8;t++){let l=document.createElement("span");l.id=e.toString()+"-"+t.toString(),l.classList.add("tile"),l.innerText="",document.getElementById("divboard").appendChild(l)}keys.forEach((e=>{const t=document.createElement("button");t.setAttribute("id",e),t.addEventListener("click",(()=>handleClick(e))),divkeyboard.append(t),"Spec"==e?lllll():t.textContent="US"==e?"_":e})),l1lll("Enter"),l1lll("Back"),level=localStorage.getItem("word500level"),null==level&&(level="A"),lang=localStorage.getItem("word500lang"),null==lang&&(lang="en"),generateWordlist(),resetGame(),changeLevel(level),changeLanguage(lang),l1ll1();let e=new Date,t=e.getUTCDate()+"-"+(parseInt(e.getUTCMonth())+1).toString()+"-"+e.getFullYear(),l=localStorage.getItem("word500date");null==l?(localStorage.setItem("word500date",t),ll1l1(t),word=llll1(localStorage.getItem(lang+level+"word"))):t==l?restoreSession():(ll1ll(),ll1l1(t),localStorage.setItem("word500date",t),word=llll1(localStorage.getItem(lang+level+"word"))),document.getElementById("flagen").addEventListener("click",(()=>flag_Click("en"))),document.getElementById("flages").addEventListener("click",(()=>flag_Click("es"))),document.getElementById("flagde").addEventListener("click",(()=>flag_Click("de"))),document.getElementById("flagfr").addEventListener("click",(()=>flag_Click("fr"))),document.getElementById("flagpt").addEventListener("click",(()=>flag_Click("pt"))),document.getElementById("flagit").addEventListener("click",(()=>flag_Click("it"))),document.getElementById("flagnl").addEventListener("click",(()=>flag_Click("nl"))),document.getElementById("flagca").addEventListener("click",(()=>flag_Click("ca"))),document.getElementById("levelA").addEventListener("click",(()=>level_Click("A"))),document.getElementById("levelB").addEventListener("click",(()=>level_Click("B"))),document.getElementById("levelC").addEventListener("click",(()=>level_Click("C"))),document.getElementById("btnstats").addEventListener("click",(()=>stats_Click())),document.getElementById("closestatspage").addEventListener("click",(()=>stats_Close())),document.addEventListener("keyup",(e=>{gameOver||("Backspace"==e.code?deleteLetter():"Enter"==e.code&&ll11l())})),document.addEventListener("keypress",(e=>{gameOver||(65<=e.keyCode&&e.keyCode<=90&&lll11(String.fromCharCode(e.keyCode)),97<=e.keyCode&&e.keyCode<=122&&lll11(String.fromCharCode(e.keyCode-32)),209!=e.keyCode&&241!=e.keyCode||lll11(String.fromCharCode(209)),199!=e.keyCode&&231!=e.keyCode||lll11(String.fromCharCode(199)),95==e.keyCode&&lll11(String.fromCharCode(95)))}))}window.onload=function(){initialize()};const generateWordlist=()=>{"en"==lang&&(exclude=en0,words="A"==level?en1:"B"==level?en1.concat(en2):en1.concat(en2,en3),wordlist=en1.concat(en2,en3,en4)),"es"==lang&&(exclude=es0,words="A"==level?es1:"B"==level?es1.concat(es2):es1.concat(es2,es3),wordlist=es1.concat(es2,es3,es4)),"nl"==lang&&(exclude=nl0,words="A"==level?nl1:"B"==level?nl1.concat(nl2):nl1.concat(nl2,nl3),wordlist=nl1.concat(nl2,nl3,nl4)),"ca"==lang&&(exclude=ca0,words="A"==level?ca1:"B"==level?ca1.concat(ca2):ca1.concat(ca2,ca3),wordlist=ca1.concat(ca2,ca3,ca4)),"de"==lang&&(exclude=de0,words="A"==level?de1:"B"==level?de1.concat(de2):de1.concat(de2,de3),wordlist=de1.concat(de2,de3,de4)),"fr"==lang&&(exclude=fr0,words="A"==level?fr1:"B"==level?fr1.concat(fr2):fr1.concat(fr2,fr3),wordlist=fr1.concat(fr2,fr3,fr4)),"pt"==lang&&(exclude=pt0,words="A"==level?pt1:"B"==level?pt1.concat(pt2):pt1.concat(pt2,pt3),wordlist=pt1.concat(pt2,pt3,pt4)),"it"==lang&&(exclude=it0,words="A"==level?it1:"B"==level?it1.concat(it2):it1.concat(it2,it3),wordlist=it1.concat(it2,it3,it4))},lllll=()=>{const e=document.getElementById("Spec");"en"!=lang&&"nl"!=lang&&"de"!=lang&&"it"!=lang||(e.classList.add("hiddenKey"),document.getElementById("Back").classList.remove("specialKey")),"ca"!=lang&&"fr"!=lang&&"pt"!=lang||(e.classList.contains("hiddenKey")&&e.classList.remove("hiddenKey"),e.textContent=String.fromCharCode(199),document.getElementById("Back").classList.add("specialKey")),"es"==lang&&(e.classList.contains("hiddenKey")&&e.classList.remove("hiddenKey"),e.textContent=String.fromCharCode(209),document.getElementById("Back").classList.add("specialKey"))},l1ll1=()=>{"A"==level?exclude.forEach((e=>{l1lll(e)})):exclude.forEach((e=>{l1l1l(e)}))},restoreSession=()=>{word=llll1(localStorage.getItem(lang+level+"word")),hintsUsed=parseInt(localStorage.getItem(lang+level+"hints")),"Yes"==localStorage.getItem(lang+level+"gameover")&&(gameOver=!0);for(let e=0;e<8;e++){if(guesses[e]=localStorage.getItem(lang+level+"guess"+e.toString()),null==guesses[e]){row=e,0==row?l1lll("Hint"):l1l1l("Hint");break}writeWord(guesses[e],e),writeResult(l1l11(guesses[e],word),e),invalidateLetters(e)}},ll1ll=()=>{levels.forEach((e=>{langs.forEach((t=>{localStorage.removeItem(t+e+"hints"),localStorage.removeItem(t+e+"gameover"),localStorage.removeItem(t+e+"word");for(let l=0;l<8;l++)localStorage.removeItem(t+e+"guess"+l.toString())}))}))},resetGame=()=>{for(let e=0;e<8;e++)for(let t=0;t<8;t++){let l=document.getElementById(e.toString()+"-"+t.toString());l.innerText="",t<5&&(l.classList.remove("flip"),l.classList.remove("red"),l.classList.remove("yellow"),l.classList.remove("green"))}keys.forEach((e=>{"Enter"==e||"Hint"==e||"Back"==e?l1lll(e):l1l1l(e)}));for(let e=0;e<5;e++){let t=document.getElementById(row.toString()+"-"+e.toString());t.classList.remove("invalidWord"),t.classList.add("validWord")}row=0,col=0,gameOver=!1,hintsUsed=0,guesses=["","","","","","","","","",""]},ll1l1=e=>{let t=weekDates.findIndex((t=>t==e));if(-1==t)alert("Houston, we have a problem! No new words have been uploaded from the server. Try again later.");else{let e=weekWords[t],l=0;langs.forEach((t=>{levels.forEach((n=>{localStorage.setItem(t+n+"hints","0"),localStorage.setItem(t+n+"gameover","No"),localStorage.setItem(t+n+"word",e[l]),l+=1}))}))}},handleClick=e=>{if(document.getElementById("Enter").focus(),!gameOver){if("Back"==e)return void deleteLetter();if("Hint"==e){if(row>0){if(0==hintsUsed){if(!confirm("This will generate a random word, that fits your previous guesses.\r\nThe game will count as a loss and your streak resets to 0!\r\nDo you want to proceed, oh lazy one?"))return}guesses[row]=lll1l(),writeWord(guesses[row],row),col=5,ll11l(),hintsUsed+=1,localStorage.setItem(lang+level+"hints",hintsUsed.toString())}return}if("Enter"==e)return void ll11l();if("Spec"==e)return void lll11(document.getElementById("Spec").textContent);if("US"==e)return void lll11("_");lll11(e)}},lll11=e=>{if(col<5){let t=document.getElementById(row.toString()+"-"+col.toString());if(""==t.innerText&&(t.innerText=e,col+=1,1==col&&l1l1l("Back"),5==col)){let e=rw();if(e.includes("_"))return;if(ll111(e))l1l1l("Enter");else for(let e=0;e<5;e++){let t=document.getElementById(row.toString()+"-"+e.toString());t.classList.remove("validWord"),t.classList.add("invalidWord")}}}},flag_Click=e=>{lang!=e&&(changeLanguage(e),generateWordlist(),resetGame(),l1ll1(),restoreSession())},changeLanguage=e=>{if(lang=e,document.getElementById("btnFlag").src="images/"+lang+".png",document.getElementById("helplink").href="help"+lang+".html",localStorage.setItem("word500lang",lang),lllll(),"en"==lang){exclude=en0;let e="";exclude.forEach((t=>{e+=t})),document.getElementById("levelAtext").innerText="- No repeat letters\n- No "+e,document.getElementById("levelBtext").innerText="- No repeat letters",document.getElementById("levelCtext").innerText="- Anything goes!"}if("es"==lang){exclude=es0;let e="";exclude.forEach((t=>{e+=t})),document.getElementById("levelAtext").innerText="- Sin letras repetidas\n- Sin "+e,document.getElementById("levelBtext").innerText="- Sin letras repetidas",document.getElementById("levelCtext").innerText="- Todo es posible!"}if("nl"==lang){exclude=nl0;let e="";exclude.forEach((t=>{e+=t})),document.getElementById("levelAtext").innerText="- Zonder dubbele letters\n- Zonder "+e,document.getElementById("levelBtext").innerText="- Zonder dubbele letters",document.getElementById("levelCtext").innerText="- Alles kan!"}if("ca"==lang){exclude=ca0;let e="";exclude.forEach((t=>{e+=t})),document.getElementById("levelAtext").innerText="- Sense lletres repetides\n- Sense "+e,document.getElementById("levelBtext").innerText="- Sense lletres repetides",document.getElementById("levelCtext").innerText="- Tot es possible!"}if("de"==lang){exclude=de0;let e="";exclude.forEach((t=>{e+=t})),document.getElementById("levelAtext").innerText="- 5 verschiedene Buchstaben\n- Ohne "+e,document.getElementById("levelBtext").innerText="- 5 verschiedene Buchstaben",document.getElementById("levelCtext").innerText="- Alles ist möglich!"}if("fr"==lang){exclude=fr0;let e="";exclude.forEach((t=>{e+=t})),document.getElementById("levelAtext").innerText="- Pas de lettres répétitives\n- Pas de "+e,document.getElementById("levelBtext").innerText="- Pas de lettres répétitives",document.getElementById("levelCtext").innerText="- Tout est possible!"}if("pt"==lang){exclude=pt0;let e="";exclude.forEach((t=>{e+=t})),document.getElementById("levelAtext").innerText="- Sem repetir letras\n- Sem "+e,document.getElementById("levelBtext").innerText="- Sem repetir letras",document.getElementById("levelCtext").innerText="- Tudo é possível!"}if("it"==lang){exclude=it0;let e="";exclude.forEach((t=>{e+=t})),document.getElementById("levelAtext").innerText="- Senza lettere ripetute\n- Senza "+e,document.getElementById("levelBtext").innerText="- Senza lettere ripetute",document.getElementById("levelCtext").innerText="- Tutto è possibile!"}},level_Click=e=>{level!=e&&(generateWordlist(),changeLevel(e),resetGame(),l1ll1(),restoreSession())},changeLevel=e=>{document.getElementById("btnLevel").src="images/"+e+".png",level=e,localStorage.setItem("word500level",level)},l1lll=e=>{"Ñ"!=e&&"Ç"!=e||(e="Spec");const t=document.getElementById(e);t.classList.remove("unusedKey"),t.classList.add("usedKey")};function ll111(e){return wordlist.includes(l11ll(e))}const l1l1l=e=>{"Ñ"!=e&&"Ç"!=e||(e="Spec");let t=document.getElementById(e);t.classList.remove("usedKey"),t.classList.add("unusedKey")},writeWord=(e,t)=>{for(let l=0;l<5;l++){document.getElementById(t.toString()+"-"+l.toString()).innerText=e[l]}},writeResult=(e,t)=>{let l=5,n=document.getElementById(t.toString()+"-"+l.toString());n.classList.add("flip"),setTimeout((()=>{n.innerText=Math.floor(e/100).toString()}),250),setTimeout((()=>{n.classList.remove("flip")}),500),l+=1;let o=document.getElementById(t.toString()+"-"+l.toString());setTimeout((()=>{o.classList.add("flip")}),500),setTimeout((()=>{o.innerText=Math.floor(e%100/10).toString()}),750),setTimeout((()=>{o.classList.remove("flip")}),1e3),l+=1;let r=document.getElementById(t.toString()+"-"+l.toString());setTimeout((()=>{r.classList.add("flip")}),1e3),setTimeout((()=>{r.innerText=(e%10).toString()}),1250),setTimeout((()=>{r.classList.remove("flip")}),1500)};function rw(){let e="";for(let t=0;t<5;t++){e+=document.getElementById(row.toString()+"-"+t.toString()).innerText}return e}const invalidateLetters=e=>{for(let t=0;t<5;t++){let l=document.getElementById(e.toString()+"-"+t.toString());l1lll(l.innerText)}},deleteLetter=()=>{0<col&&col<=5&&(col-=1),4==col&&l1lll("Enter"),0==col&&l1lll("Back"),document.getElementById(row.toString()+"-"+col.toString()).innerText="";for(let e=0;e<5;e++){let t=document.getElementById(row.toString()+"-"+e.toString());t.classList.remove("invalidWord"),t.classList.add("validWord")}},ll11l=()=>{if(col<5)return;let e=rw();if(!ll111(e))return;invalidateLetters(row),guesses[row]=e,localStorage.setItem(lang+level+"guess"+row.toString(),e),l1lll("Back"),l1lll("Enter");let t=l1l11(word,e);if(writeResult(t,row),500==t){if(gameOver=!0,localStorage.setItem(lang+level+"gameover","Yes"),hintsUsed>0){localStorage.setItem(lang+level+"currentstreak","0");let e=localStorage.getItem(lang+level+"lost");null==e?localStorage.setItem(lang+level+"lost","1"):localStorage.setItem(lang+level+"lost",(1+parseInt(e)).toString())}else{let e=localStorage.getItem(lang+level+"wins");if(null==e)localStorage.setItem(lang+level+"wins","1"),localStorage.setItem(lang+level+"currentstreak","1"),localStorage.setItem(lang+level+"maxstreak","1"),localStorage.setItem(lang+level+(1+row).toString(),"1");else{let t=localStorage.getItem(lang+level+"currentstreak"),l=localStorage.getItem(lang+level+"maxstreak"),n=localStorage.getItem(lang+level+(1+row).toString());localStorage.setItem(lang+level+"wins",(1+parseInt(e)).toString()),localStorage.setItem(lang+level+"currentstreak",(1+parseInt(t)).toString()),t==l&&localStorage.setItem(lang+level+"maxstreak",(1+parseInt(l)).toString()),null==n?localStorage.setItem(lang+level+(1+row).toString(),"1"):localStorage.setItem(lang+level+(1+row).toString(),(1+parseInt(n)).toString())}}setTimeout((()=>{if(hintsUsed>0)sm(hintsUsed==row?"Mashing that Hints button is fun!":1==hintsUsed?"Solved, pity you used that one hint":"Solved, next time, try without hints");else switch(row){case 0:sm("Are you Chuck Norris?");break;case 1:sm("You lucky skunk!");break;case 2:sm("Amazing!");break;case 3:sm("Excellent!");break;case 4:sm("Splendid!");break;case 5:sm("Very good!");break;case 6:sm("You did it!");break;case 7:sm("Nice! That was close!")}row+=1,1==row&&l1l1l("Hint")}),1500),setTimeout((()=>{animateBoard()}),4e3)}else row+=1,1==row&&l1l1l("Hint");if(col=0,!gameOver&&8==row){gameOver=!0,localStorage.setItem(lang+level+"gameover","Yes"),localStorage.setItem(lang+level+"currentstreak","0");let e=localStorage.getItem(lang+level+"lost");null==e?localStorage.setItem(lang+level+"lost","1"):localStorage.setItem(lang+level+"lost",(1+parseInt(e)).toString()),sm("Game over! The word was "+word)}};function l1l11(e,t){let l=5;for(let n=0;n<5;n++)e[n]==t[n]&&(l+=99,e=e.substring(0,n)+"$"+e.substring(n+1,5),t=t.substring(0,n)+"%"+t.substring(n+1,5));for(let n=0;n<5;n++)for(let o=0;o<5;o++)e[n]==t[o]&&(l+=9,e=e.substring(0,n)+"$"+e.substring(n+1,5),t=t.substring(0,o)+"%"+t.substring(o+1,5));return l}function llll1(e){let t,l="";for(let n=0;n<5;n++)t=e.charCodeAt(n),l=t>100?String.fromCharCode(408-t)+l:String.fromCharCode(90-(95-t-n)%26)+l;return l}function lll1l(){if(col=5){let e=rw();if(!e.includes("_")&&!ll111(e))for(let e=0;e<5;e++){let t=document.getElementById(row.toString()+"-"+e.toString());t.classList.remove("invalidWord"),t.classList.add("validWord")}}let e=!0;for(let t=0;t<words.length;t++){e=!0;for(let l=0;l<row;l++)l1l11(guesses[l],llll1(words[t]))!==l1l11(guesses[l],word)&&(e=!1);if(e&&word!==llll1(words[t]))return llll1(words[t])}return word}const sm=e=>{const t=document.getElementById("title");t.innerText=e,setTimeout((()=>t.innerText="Word500"),2500)},animateBoard=()=>{for(let e=0;e<row;e++)for(let t=0;t<5;t++)setTimeout((()=>{document.getElementById(e.toString()+"-"+t.toString()).classList.add("flip")}),200*t+1e3*e);setTimeout((()=>{stats_Click()}),1e3*row+500);for(let e=0;e<row;e++){let t=guesses[e],l=word;for(let n=0;n<5;n++)t[n]==l[n]&&(setTimeout((()=>{document.getElementById(e.toString()+"-"+n.toString()).classList.add("green")}),200*n+1e3*e+250),t=t.substring(0,n)+"$"+t.substring(n+1,5),l=l.substring(0,n)+"%"+l.substring(n+1,5));for(let n=0;n<5;n++)for(let o=0;o<5;o++)t[n]==l[o]&&(setTimeout((()=>{document.getElementById(e.toString()+"-"+n.toString()).classList.add("yellow")}),200*n+1e3*e+250),t=t.substring(0,n)+"$"+t.substring(n+1,5),l=l.substring(0,o)+"%"+l.substring(o+1,5));for(let l=0;l<5;l++)"$"!==t[l]&&setTimeout((()=>{document.getElementById(e.toString()+"-"+l.toString()).classList.add("red")}),200*l+1e3*e+250)}},stats_Click=()=>{document.getElementById("statspage").style.display="block",showstats()},stats_Close=()=>{document.getElementById("statspage").style.display="none"};function showstats(){let e,t=0,l=0,n=0,o=0,r=[0,0,0,0,0,0,0,0,0],a=0,s=localStorage.getItem("word500level");null==s&&(s="A");let d=localStorage.getItem("word500lang");null==d&&(d="en");let i=localStorage.getItem(d+s+"wins");null!==i&&(t=parseInt(i)),i=localStorage.getItem(d+s+"lost"),null!==i&&(l=parseInt(i)),i=localStorage.getItem(d+s+"currentstreak"),null!==i&&(o=parseInt(i)),i=localStorage.getItem(d+s+"maxstreak"),null!==i&&(n=parseInt(i));let c=t+l;e=0==c?"Word500 virgin":c<10?"Word500 starter":c<25?"Word500 adept":c<50?"Word500 veteran":c<100?"Word500 expert":c<1e3?"Word500 superstar":"Word500 bot or hacker (or both)",c>0&&(a=(Math.round(1e3*t/c)/10).toString()+"%");for(let e=1;e<9;e++){let t=localStorage.getItem(d+s+e.toString());r[e]=null==t?0:parseInt(t)}for(let e=1;e<9;e++)document.getElementById("bartext"+e.toString()).innerText=r[e].toString(),document.getElementById("barfill"+e.toString()).style.width=Math.round(100*r[e]/t).toString()+"%";document.getElementById("flag").src="images/"+d+".png",document.getElementById("level").src="images/"+s+".png",document.getElementById("played").innerText="Games played: "+c.toString(),document.getElementById("status").innerText="Status: "+e,document.getElementById("win").innerText="Win percentage: "+a,document.getElementById("streak").innerText="Current streak: "+o.toString(),document.getElementById("max").innerText="Max streak: "+n.toString()}function l11ll(e){let t,l="";for(let n=0;n<5;n++)t=e.charCodeAt(n),l=t>100?String.fromCharCode(408-t)+l:String.fromCharCode(65+(t+n-64)%26)+l;return l}function countDown(){let e,t=new Date,l=t.getUTCHours(),n=t.getUTCMinutes(),o=t.getUTCSeconds();o=(60-o)%60,n=(60-n-Math.ceil(o/60))%60,l=24-l-Math.ceil((o+n)/120),e=l<10?"0"+l.toString():l.toString(),e=n<10?e+":0"+n.toString():e+":"+n.toString(),e=o<10?e+":0"+o.toString():e+":"+o.toString(),document.getElementById("timer").innerText=gameOver?"Next Word500 in "+e:""}setInterval(countDown,1e3);